# HYCU for Microsoft 365 - Outil d'Ã‰valuation de Dimensionnement

[![Version](https://img.shields.io/badge/version-4.4--HYCU-blue.svg)](https://github.com)
[![PowerShell](https://img.shields.io/badge/PowerShell-5.1%2B-blue.svg)](https://docs.microsoft.com/powershell/)
[![License](https://img.shields.io/badge/license-Proprietary-red.svg)](LICENSE)

## ğŸ“‹ Vue d'ensemble

Cet outil PowerShell analyse votre environnement Microsoft 365 pour fournir des informations prÃ©cises de dimensionnement pour la planification de sauvegarde et de rÃ©cupÃ©ration avec **HYCU**. Il gÃ©nÃ¨re un rapport HTML professionnel avec des statistiques d'utilisation pour Exchange Online, OneDrive for Business et SharePoint Online.

### ğŸ¯ Objectifs

- **Ã‰valuer** l'utilisation actuelle de votre environnement M365
- **Calculer** les besoins de stockage pour les sauvegardes HYCU
- **PrÃ©voir** la croissance annuelle des donnÃ©es
- **Planifier** le dimensionnement de votre solution HYCU

---

## âœ¨ FonctionnalitÃ©s

### ğŸ“Š Collecte de donnÃ©es
- âœ… **Exchange Online** : BoÃ®tes aux lettres utilisateurs et partagÃ©es
- âœ… **OneDrive for Business** : Stockage personnel des utilisateurs
- âœ… **SharePoint Online** : Sites d'Ã©quipe et de communication
- âœ… **BoÃ®tes d'archivage** : Support optionnel (paramÃ¨tre)
- âœ… **Filtrage par groupe** : Analyse ciblÃ©e sur un groupe Azure AD

### ğŸ“ˆ Analyse avancÃ©e
- Calcul du stockage total par service
- Moyenne de stockage par utilisateur/site
- Tendances de croissance annuelle (basÃ©es sur 180 jours)
- Identification automatique des boÃ®tes partagÃ©es

### ğŸ¨ Rapport HTML professionnel
- Design moderne inspirÃ© de HYCU.com
- Interface responsive (desktop/mobile/tablette)
- Visualisation claire avec cartes mÃ©triques
- Graphiques de croissance avec badges
- Export et impression optimisÃ©s
- Branding HYCU complet

---

## ğŸ“‹ PrÃ©requis

### ğŸ”§ Configuration systÃ¨me requise

| Composant | Requis |
|-----------|--------|
| **SystÃ¨me d'exploitation** | Windows 10/11, Windows Server 2016+ |
| **PowerShell** | Version 5.1 ou supÃ©rieure |
| **Modules PowerShell** | Microsoft.Graph.Reports<br/>ExchangeOnlineManagement |
| **ConnectivitÃ©** | AccÃ¨s Internet pour Microsoft 365 |

### ğŸ‘¤ Permissions requises

#### Permissions Microsoft Graph API
- `Reports.Read.All` - **Requis**
- `Group.Read.All` - Optionnel (pour filtrage par groupe)
- `GroupMember.Read.All` - Optionnel (pour filtrage par groupe)
- `User.Read.All` - Optionnel (pour filtrage par groupe)

#### RÃ´les administratifs
- **Reports Reader** - Minimum requis
- **Global Reader** - RecommandÃ© pour accÃ¨s complet
- **Exchange Administrator** - Requis si analyse des boÃ®tes d'archivage

---

## ğŸš€ Installation

### Ã‰tape 1 : Installer les modules PowerShell

Ouvrez PowerShell en tant qu'administrateur et exÃ©cutez :

```powershell
# Installer le module Microsoft Graph Reports
Install-Module Microsoft.Graph.Reports -Scope CurrentUser -Force

# Installer le module Exchange Online Management
Install-Module ExchangeOnlineManagement -Scope CurrentUser -Force

# VÃ©rifier l'installation
Get-Module -ListAvailable -Name Microsoft.Graph.Reports, ExchangeOnlineManagement
```

### Ã‰tape 2 : TÃ©lÃ©charger le script

TÃ©lÃ©chargez le fichier `Get-M365SizingInfo-HYCU.ps1` dans un rÃ©pertoire de votre choix.

### Ã‰tape 3 : Configurer la politique d'exÃ©cution (si nÃ©cessaire)

```powershell
# VÃ©rifier la politique actuelle
Get-ExecutionPolicy

# Si "Restricted", modifier la politique
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

## ğŸ’» Utilisation

### ğŸ“Œ Syntaxe de base

```powershell
.\Get-M365SizingInfo-HYCU.ps1 [-AzureAdGroupName <string>] [-SkipArchiveMailbox <bool>] [-EnableDebug <bool>] [-OutputObject]
```

### ğŸ¯ Exemples d'utilisation

#### Exemple 1 : Analyse complÃ¨te de l'environnement

```powershell
.\Get-M365SizingInfo-HYCU.ps1
```

**RÃ©sultat** : Analyse tous les utilisateurs et gÃ©nÃ¨re le rapport complet.

---

#### Exemple 2 : Analyse d'un groupe spÃ©cifique

```powershell
.\Get-M365SizingInfo-HYCU.ps1 -AzureAdGroupName "DÃ©partement Marketing"
```

**RÃ©sultat** : Analyse uniquement les membres du groupe "DÃ©partement Marketing".

---

#### Exemple 3 : Inclure les boÃ®tes d'archivage

```powershell
.\Get-M365SizingInfo-HYCU.ps1 -SkipArchiveMailbox $false
```

**RÃ©sultat** : Inclut l'analyse des boÃ®tes aux lettres d'archivage (peut Ãªtre long).

---

#### Exemple 4 : Mode dÃ©bogage

```powershell
.\Get-M365SizingInfo-HYCU.ps1 -EnableDebug $true
```

**RÃ©sultat** : Affiche des logs dÃ©taillÃ©s pour le dÃ©pannage.

---

#### Exemple 5 : Export des donnÃ©es en objet PowerShell

```powershell
$sizingData = .\Get-M365SizingInfo-HYCU.ps1 -OutputObject
$sizingData.Exchange
$sizingData.OneDrive
$sizingData.SharePoint
```

**RÃ©sultat** : Retourne les donnÃ©es sous forme d'objet pour traitement ultÃ©rieur.

---

### âš™ï¸ ParamÃ¨tres dÃ©taillÃ©s

| ParamÃ¨tre | Type | DÃ©faut | Description |
|-----------|------|--------|-------------|
| `-AzureAdGroupName` | String | - | Nom du groupe Azure AD pour filtrer l'analyse |
| `-SkipArchiveMailbox` | Boolean | `$true` | Si `$true`, ignore les boÃ®tes d'archivage |
| `-EnableDebug` | Boolean | `$false` | Active les logs de dÃ©bogage dÃ©taillÃ©s |
| `-OutputObject` | Switch | - | Retourne l'objet de donnÃ©es au lieu du rapport HTML uniquement |

---

## ğŸ“Š Structure du rapport

### ğŸ“„ Rapport HTML gÃ©nÃ©rÃ©

Le rapport `HYCU-M365-Sizing-Report.html` contient :

#### ğŸ¨ En-tÃªte
- Logo et branding HYCU
- Date et heure de gÃ©nÃ©ration
- PÃ©riode d'analyse (180 jours)
- Version du script

#### ğŸ“ˆ RÃ©sumÃ© exÃ©cutif
- **Nombre total d'utilisateurs**
- **Stockage total** (en GB)
- **Nombre de workloads** protÃ©gÃ©s

#### ğŸ“§ Section Exchange Online
- Nombre de boÃ®tes aux lettres (utilisateurs/partagÃ©es)
- Stockage total et par utilisateur
- Taux de croissance annuelle

#### â˜ï¸ Section OneDrive for Business
- Nombre d'utilisateurs actifs
- Stockage total et par utilisateur
- Taux de croissance annuelle

#### ğŸŒ Section SharePoint Online
- Nombre de sites actifs
- Stockage total et par site
- Taux de croissance annuelle

#### ğŸ”— Pied de page
- Appel Ã  l'action vers HYCU.com
- Informations de support

---

## ğŸ” Exemple de donnÃ©es collectÃ©es

### Structure de l'objet retournÃ©

```powershell
@{
    Exchange = @{
        NumberOfUsers = 1247
        TotalSizeGB = 3845.67
        SizePerUserGB = 3.08
        AverageGrowthPercent = 18
        ArchiveMailboxes = 145      # Si -SkipArchiveMailbox $false
        ArchiveSizeGB = 892.34      # Si -SkipArchiveMailbox $false
    }
    OneDrive = @{
        NumberOfUsers = 1189
        TotalSizeGB = 2967.23
        SizePerUserGB = 2.49
        AverageGrowthPercent = 22
    }
    SharePoint = @{
        NumberOfSites = 87
        TotalSizeGB = 1840.15
        SizePerUserGB = 21.15
        AverageGrowthPercent = 14
    }
}
```

---

## ğŸ› ï¸ DÃ©pannage

### âŒ Erreurs courantes

#### Erreur : "Module not found"

```
Required module not found: Microsoft.Graph.Reports
```

**Solution** :
```powershell
Install-Module Microsoft.Graph.Reports -Scope CurrentUser -Force
```

---

#### Erreur : "Forbidden (Forbidden)"

```
The user account used for authentication must have permissions covered by Reports Reader admin role.
```

**Solution** :
- VÃ©rifiez que le compte a le rÃ´le **Reports Reader** dans Azure AD
- Contactez votre administrateur Microsoft 365

---

#### Erreur : "Failed to setup session"

```
ERROR - Failed to setup session after multiple tries
```

**Solution** :
- VÃ©rifiez votre connexion Internet
- VÃ©rifiez les identifiants Microsoft 365
- DÃ©sactivez temporairement le VPN si applicable
- RÃ©essayez dans 15-30 minutes (limite de dÃ©bit API)

---

#### Avertissement : "Could not retrieve data"

```
Warning: Could not retrieve Exchange/OneDrive/SharePoint data
```

**Solution** :
- VÃ©rifiez les permissions API
- VÃ©rifiez que les services sont activÃ©s dans votre tenant
- Consultez les logs avec `-EnableDebug $true`

---

### ğŸ“ Activer le mode dÃ©bogage

Pour des informations dÃ©taillÃ©es lors de l'exÃ©cution :

```powershell
.\Get-M365SizingInfo-HYCU.ps1 -EnableDebug $true 2>&1 | Tee-Object -FilePath "debug.log"
```

Cela crÃ©era un fichier `debug.log` avec tous les dÃ©tails d'exÃ©cution.

---

## ğŸ“ˆ Calcul de la croissance

### MÃ©thodologie

Le script calcule la croissance annuelle en :

1. **Collectant** les donnÃ©es de stockage sur 180 jours
2. **Calculant** le taux de croissance quotidien moyen
3. **Extrapolant** sur une annÃ©e (x2)
4. **Arrondissant** Ã  l'entier supÃ©rieur pour une estimation conservative

### Formule

```
Croissance Quotidienne = ((Stockage_Jour_N / Stockage_Jour_N-1) - 1) Ã— 100
Croissance Moyenne = Moyenne(Tous les jours)
Croissance Annuelle = Plafond(Croissance Moyenne Ã— 2)
```

**Note** : Cette estimation est conservative et peut varier selon les habitudes d'utilisation.

---

## ğŸ” SÃ©curitÃ© et confidentialitÃ©

### ğŸ›¡ï¸ Bonnes pratiques

- âœ… Le script ne stocke **aucune donnÃ©e** en dehors du rapport HTML local
- âœ… Les identifiants ne sont **jamais enregistrÃ©s** dans le script
- âœ… Les connexions utilisent **OAuth moderne** (pas de mot de passe en clair)
- âœ… Le rapport peut Ãªtre **supprimÃ©** aprÃ¨s consultation
- âœ… Utilisez un compte avec **permissions minimales** (Reports Reader)

### ğŸ”’ Recommandations

- ExÃ©cutez le script depuis un poste de travail sÃ©curisÃ©
- Ne partagez pas le rapport par email non chiffrÃ©
- Supprimez les rapports aprÃ¨s utilisation
- VÃ©rifiez les permissions du compte d'exÃ©cution

---

## ğŸ“ Support et documentation

### ğŸŒ Ressources HYCU

- **Site Web** : [https://hycu.com](https://hycu.com)


### ğŸ“š Documentation Microsoft

- **Microsoft Graph API** : [https://docs.microsoft.com/graph](https://docs.microsoft.com/graph)
- **Exchange Online PowerShell** : [https://docs.microsoft.com/powershell/exchange](https://docs.microsoft.com/powershell/exchange)
- **Azure AD Roles** : [https://docs.microsoft.com/azure/active-directory/roles](https://docs.microsoft.com/azure/active-directory/roles)

---

## ğŸ”„ Changelog

### Version 4.4-HYCU (Janvier 2026)
- âœ¨ Nouvelle interface HTML moderne inspirÃ©e de HYCU.com
- âœ¨ Branding HYCU complet (logo, couleurs, CTA)
- ğŸ”§ Optimisation du code pour meilleures performances
- ğŸ”§ AmÃ©lioration des messages d'erreur
- ğŸ”§ Ajout de barres de progression
- ğŸ“ Documentation enrichie
- ğŸ› Corrections diverses de bugs
- âŒ Suppression de toute rÃ©fÃ©rence Ã  d'autres marques

---

## ğŸ“„ Licence

Ce script est fourni par **HYCU, Inc.** dans le cadre des services professionnels.

Copyright Â© 2026 HYCU, Inc. Tous droits rÃ©servÃ©s.

---

## ğŸ‘¥ Auteurs

- **HYCU Professional Services Team**
- Version optimisÃ©e : Janvier 2026

---

## ğŸ¤ Contribution

Pour toute suggestion d'amÃ©lioration ou rapport de bug, contactez votre reprÃ©sentant HYCU.

---

## âš ï¸ Avertissements

- Ce script nÃ©cessite des permissions d'administration dans Microsoft 365
- L'exÃ©cution peut prendre 5-30 minutes selon la taille de l'environnement
- L'analyse des boÃ®tes d'archivage peut augmenter significativement le temps d'exÃ©cution
- Les API Microsoft 365 ont des limites de dÃ©bit - espacez les exÃ©cutions
- Les rÃ©sultats sont basÃ©s sur les donnÃ©es des 180 derniers jours

---

## ğŸ“Š Exemple visuel

Le rapport gÃ©nÃ©rÃ© ressemble Ã  ceci :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          HYCU for Microsoft 365                              â•‘
â•‘      Environment Sizing Assessment Report                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  RÃ‰SUMÃ‰ EXÃ‰CUTIF                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘  â”‚ Total Users â”‚ Total Storage   â”‚ Workloads       â”‚       â•‘
â•‘  â”‚    1,247    â”‚    8,652 GB     â”‚      3          â”‚       â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                              â•‘
â•‘  ğŸ“§ EXCHANGE ONLINE                                         â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘  â”‚ Mailboxes: 1,247 | Storage: 3,845 GB           â”‚       â•‘
â•‘  â”‚ Avg/User: 3.08 GB | Growth: 18% annually       â”‚       â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                              â•‘
â•‘  â˜ï¸ ONEDRIVE FOR BUSINESS                                   â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘  â”‚ Users: 1,189 | Storage: 2,967 GB               â”‚       â•‘
â•‘  â”‚ Avg/User: 2.49 GB | Growth: 22% annually       â”‚       â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                              â•‘
â•‘  ğŸŒ SHAREPOINT ONLINE                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘  â”‚ Sites: 87 | Storage: 1,840 GB                  â”‚       â•‘
â•‘  â”‚ Avg/Site: 21.15 GB | Growth: 14% annually      â”‚       â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                              â•‘
â•‘  Ready to Protect Your Microsoft 365 Environment?          â•‘
â•‘  Learn More at hycu.com                                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

**Pour toute question, visitez [hycu.com](https://hycu.com) ou contactez votre Ã©quipe HYCU.**


